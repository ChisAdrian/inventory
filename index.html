<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Scanner</title>
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
    <style>
        #reader {
           
           width :75vw;
			height:75vh;
            margin: auto;
        }
        #controls {
            margin-top: 10px;
            text-align: center;
        }
        #result {
            text-align: center;
            margin-top: 10px;
            font-size: 1.2em;
        }
        button {
            padding: 10px 20px;
            font-size: 1em;
            margin: 5px;
        }
    </style>
</head>
<body>

<div id="reader"></div>
<div id="result"></div>
<div id="controls">
    <button id="startButton">Start Scanning</button>
    <button id="stopButton">Stop Scanning</button>
</div>

<script>
    let html5QrCode;

    function onScanSuccess(decodedText, decodedResult) {
        // Handle the result here.
        console.log(`Scan result: ${decodedText}`, decodedResult);
        document.getElementById('result').innerText = `Scan result: ${decodedText}`;
		alert(decodedText);
		if (html5QrCode) {
            html5QrCode.stop().then(() => {
                console.log("QR Code scanning stopped.");
                html5QrCode = null;
            }).catch(err => {
                console.error(`Error stopping the scanner: ${err}`);
            });
        }
		
    }

    function onScanError(errorMessage) {
        // Handle scan error
       // console.warn(`Scan error: ${errorMessage}`);
    }

    document.getElementById('startButton').addEventListener('click', () => {
        // If scanner is already running, do nothing.
        if (html5QrCode) {
            return;
        }

        html5QrCode = new Html5Qrcode("reader");

        // Calculate the qrbox size based on the reader element dimensions.
        const readerElement = document.getElementById('reader');
        const qrboxSize = Math.min(readerElement.clientWidth, readerElement.clientHeight) * 0.9;
		let scaleSize = Math.min(250,qrboxSize - (qrboxSize/5))

        // Specify the configuration of the scanner.
        const config = { fps: 10,
		qrbox: { width: 250, height: 250 }
		};

        // Start the scanner.
        html5QrCode.start(
            { facingMode: "environment" }, // Use back camera
            config,
            onScanSuccess,
            onScanError
        ).catch(err => {
            console.error(`Error starting the scanner: ${err}`);
        });
    });

    document.getElementById('stopButton').addEventListener('click', () => {
        if (html5QrCode) {
            html5QrCode.stop().then(() => {
                console.log("QR Code scanning stopped.");
                html5QrCode = null;
            }).catch(err => {
                console.error(`Error stopping the scanner: ${err}`);
            });
        }
    });
</script>

</body>
</html>
